<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DASHLINO - Dashboard Ejecutivo</title>
    
    <!-- Estilos -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- SheetJS para leer Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="dashboard-ejecutivo">
        
        <!-- LOADING OVERLAY -->
        <div class="loading-overlay" id="loadingOverlay">
            <div style="text-align: center;">
                <div class="spinner"></div>
                <p style="margin-top: 12px; font-weight: 600; color: #6b7280; font-size: 13px;">Cargando datos...</p>
            </div>
        </div>

        <!-- MODAL -->
        <div class="modal-overlay" id="modalOverlay">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="modalTitle">Modal</h2>
                    <button class="modal-close" onclick="cerrarModal()">‚úï</button>
                </div>
                <div id="modalBody"></div>
            </div>
        </div>

        <!-- HEADER -->
        <div class="dashboard-header">
            <div class="header-content">
                <div>
                    <div class="brand-title">DASHLINO</div>
                    <div class="brand-subtitle">Sistema de An√°lisis y Control de Contratistas</div>
                </div>
                <div style="text-align: right;">
                    <div class="date-mes" id="mesActual">CARGANDO...</div>
                    <div class="date-update" id="fechaActualizacion">Actualizado --</div>
                </div>
            </div>
        </div>

        <!-- SELECTOR DE MES -->
        <div class="mes-selector" id="mesSelector">
            <!-- Los tabs se generan din√°micamente -->
        </div>

        <div class="dashboard-body" id="dashboardBody">
            
            <!-- KPI HERO -->
            <div class="kpi-hero">
                <div class="kpi-hero-label">üéØ TASA DE CAPTURA GLOBAL</div>
                <div class="kpi-hero-value" id="capturaGlobal">--.--%</div>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="progressBar" style="width: 0%"></div>
                    <div class="progress-bar-objetivo">
                        <div class="objetivo-marker"></div>
                        <div class="objetivo-label">Meta: 90%</div>
                    </div>
                </div>
                <div class="kpi-hero-stats" id="heroStats">
                    <!-- Stats din√°micos -->
                </div>
            </div>

            <!-- PANORAMA GENERAL -->
            <div class="panorama-general">
                <div class="panorama-title">üìä Panorama General - <span id="panoramaMes">--</span></div>
                <div class="panorama-grid">
                    <div class="panorama-item" onclick="mostrarFaltantesTotales()">
                        <div class="panorama-label">Contratos Pendientes</div>
                        <div class="panorama-valor" id="panoramaFaltantes">--</div>
                        <div class="panorama-delta" style="color: #6b7280;">Cr√≠ticas + En Proceso</div>
                    </div>
                    <div class="panorama-item" onclick="mostrarTodasUnidades()">
                        <div class="panorama-label">Unidades al 100%</div>
                        <div class="panorama-valor"><span id="panoramaUnidades100">--</span>/23</div>
                        <div class="panorama-delta" style="color: #6b7280;">del total üéØ</div>
                    </div>
                    <div class="panorama-item" onclick="mostrarExplicacionMejora()">
                        <div class="panorama-label">Mejora Acumulada</div>
                        <div class="panorama-valor" id="panoramaMejora">--</div>
                        <div class="panorama-delta" style="color: #16a34a;">üìà</div>
                    </div>
                    <div class="panorama-item" onclick="mostrarExplicacionVelocidad()">
                        <div class="panorama-label">‚ö° Velocidad</div>
                        <div class="panorama-valor" id="panoramaVelocidad">--</div>
                        <div class="panorama-delta" style="color: #0891b2;">Contratos incorporados</div>
                    </div>
                    <div class="panorama-item" onclick="mostrarExplicacionDuplicados()">
                        <div class="panorama-label">üîÑ Duplicados</div>
                        <div class="panorama-valor" id="panoramaDuplicados">--</div>
                        <div class="panorama-delta" style="color: #6b7280;">Detectados</div>
                    </div>
                    <div class="panorama-item" onclick="mostrarExplicacionPadron()">
                        <div class="panorama-label">PADR√ìN</div>
                        <div class="panorama-valor" id="panoramaPadron">--</div>
                        <div class="panorama-delta" style="color: #16a34a;">Contratos registrados</div>
                    </div>
                </div>
            </div>

            <!-- ESTADO UNIDADES -->
            <div class="estado-unidades-grid">
                <div class="estado-card estado-ok" onclick="mostrarUnidades100()">
                    <div class="estado-numero" id="unidades100">--</div>
                    <div class="estado-label">Unidades al 100%</div>
                    <div class="estado-detalle">Captura completa</div>
                </div>
                
                <div class="estado-card estado-riesgo" onclick="mostrarUnidadesEnProceso()">
                    <div class="estado-numero" id="unidadesEnProceso">--</div>
                    <div class="estado-label">En Proceso</div>
                    <div class="estado-detalle">70-99% captura</div>
                </div>
                
                <div class="estado-card estado-critico" onclick="mostrarUnidadesCriticas()">
                    <div class="estado-numero" id="unidadesCriticas">--</div>
                    <div class="estado-label">Requieren Atenci√≥n</div>
                    <div class="estado-detalle">&lt;70% captura</div>
                </div>
                
                <div class="estado-card estado-contratos" onclick="mostrarFaltantesTotales()">
                    <div class="estado-numero" id="faltantesTotales">--</div>
                    <div class="estado-label">Contratos Pendientes</div>
                    <div class="estado-detalle" style="color: #6b7280;">Total faltantes</div>
                </div>
                
                <div class="estado-card estado-nuevos" onclick="mostrarExplicacionVelocidad()">
                    <div class="estado-numero" id="incorporados">--</div>
                    <div class="estado-label">Incorporados</div>
                    <div class="estado-detalle" id="detalleIncorporados" style="color: #0891b2;">este mes</div>
                </div>
            </div>

            <!-- CONCENTRACI√ìN 80/20 -->
            <div class="concentracion-section">
                <div class="concentracion-header">üéØ Concentraci√≥n de Problemas (80/20)</div>
                <div class="concentracion-barra">
                    <div class="concentracion-fill" id="concentracionFill" style="width: 0%;">--</div>
                </div>
                <div class="top4-grid" id="top4Grid">
                    <!-- Generado din√°micamente -->
                </div>
                <div class="concentracion-footer" id="concentracionFooter">
                    üí° Cargando an√°lisis de concentraci√≥n...
                </div>
            </div>

            <!-- GR√ÅFICA -->
            <div class="card-grafica">
                <div class="card-header">üìà Evoluci√≥n + Proyecci√≥n</div>
                <div class="chart-container">
                    <canvas id="chartEvolucion"></canvas>
                </div>
            </div>

            <!-- MEJORAS Y DETERIOROS -->
            <div class="evolucion-grid">
                <div class="evolucion-card evolucion-mejoras">
                    <div class="evolucion-header">üèÜ Top Mejoras del Per√≠odo</div>
                    <div id="evolucionMejoras">
                        <!-- Generado din√°micamente -->
                    </div>
                </div>

                <div class="evolucion-card evolucion-deterioros">
                    <div class="evolucion-header">‚ö†Ô∏è Requiere Atenci√≥n</div>
                    <div id="evolucionDeterioros">
                        <!-- Generado din√°micamente -->
                    </div>
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="dashboard-footer">
            <div class="footer-divider"></div>
            <div class="footer-content">
                <div>
                    <span class="footer-brand">DASHLINO v2.0</span>
                    <span style="margin: 0 8px;">‚Ä¢</span>
                    <span>GRUPO M√âXICO</span>
                </div>
                <div class="footer-valor" id="footerDuplicados" onclick="mostrarExplicacionDuplicados()">
                    üíé Cargando...
                </div>
            </div>
        </div>
    </div>

    <!-- M√ìDULOS JS -->
    <script src="js/config.js"></script>
    <script src="js/lectorExcel.js"></script>
    <script src="js/procesador.js"></script>
    <script src="js/graficas.js"></script>
    <script src="js/modales.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
